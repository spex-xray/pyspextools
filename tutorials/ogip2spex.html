
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>OGIP2spex - Convert OGIP files to SPEX format &#8212; pyspextools 0.5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TG2Spex - Convert Chandra grating data" href="tg2spex.html" />
    <link rel="prev" title="Pyspextools tutorials" href="../tutorials.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ogip2spex-convert-ogip-files-to-spex-format">
<span id="ogip2spex"></span><h1>OGIP2spex - Convert OGIP files to SPEX format<a class="headerlink" href="#ogip2spex-convert-ogip-files-to-spex-format" title="Permalink to this headline">¶</a></h1>
<p>OGIP2spex is a script that converts OGIP spectra and responses to SPEX format, similar to the trafo program in SPEX.</p>
<p>The ogip2spex works with command-line arguments to gather all the input, contrary to trafo, which asks questions
interactively. When pyspextools is installed, the ogip2spex program can show an overview of the available command-line
arguments directly from the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogip2spex</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>A full overview of the arguments is given below in the section <a class="reference internal" href="#ogip2spex-commandline">Command-line arguments</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default ogip2spex creates spo files with the ‘Exp_Rate’ column. This column was added in SPEX version 3.05.00.
The Exp_Rate column contains the ratio between the backscale values of the source and background spectrum and is
used to properly simulate spectra. If you need to simulate spectra including background, then make sure the Exp_Rate
column is created.</p>
</div>
<p>For some missions, the provided PHA file contains counts, but also a <code class="docutils literal notranslate"><span class="pre">STAT_ERR</span></code> column with non-Poisson errors.
It is usually a good idea to use Poisson statistics in these cases. Ogip2spex has the <code class="docutils literal notranslate"><span class="pre">--force-poisson</span></code>
flag to make sure that the error on the counts is the square root of the number of observed counts.</p>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Suppose one would like to convert a set of OGIP spectra from the MOS instrument aboard XMM-Newton. The XMM-Newton SAS
software has provided a <em>M1.pi</em> file with the source spectrum, <em>M1_bkg.pi</em> with the source background, <em>M1.rmf</em>
containing the response matrix and <em>M1.arf</em> with the effective area. These files can be converted into SPEX format
within one go:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>linux:~&gt; ogip2spex --phafile M1.pi --bkgfile M1_bkg.pi --rmffile M1.rmf --arffile M1.arf --spofile M1.spo --resfile M1.res
</pre></div>
</div>
<p>The output starts by listing and checking the input OGIP files:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>==================================
 This is ogip2spex version 0.2
==================================

Input PHA file: M1.pi
Input Background file: M1_bkg.pi
Input Response file: M1.rmf
Input Effective area file: M1.arf
Check OGIP source spectrum... OK
Check OGIP background spectrum... OK
Check OGIP response matrix... OK
Check OGIP effective area file... OK
</pre></div>
</div>
<p>Then the program converts the OGIP files to SPEX format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Convert OGIP spectra to spo format... WARNING Lowest channel boundary energy is 0. Set to 1E-5 to avoid problems.
OK
Convert OGIP response to res format... OK
</pre></div>
</div>
<p>In this case, the lowest energy boundary of the first channel of the MOS spectrum is 0, which SPEX does not like. Since
this bin is not used, it does not hurt to change this zero into a small number (smaller than the upper boundary), in
this case 1E-5.</p>
<p>The program continues with detecting bad channels in the spectrum and channels with zero response in the response
matrix:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Identify bad channels in spectrum and response matrix and re-index matrix... OK
Number of good channels: 795
Number of bad channels:  5
Removing bad channels from spectral region... OK
Number of original groups:       2394
Number of zero-response groups:  0
Number of original response elements:  1000056
Number of bad response elements:       0
Removing bad channels from response matrix... OK
</pre></div>
</div>
<p>The removal of bad channels is default behavior. In cases where the bad channels should be kept, one can add the
‘–keep-badchannels’ argument to the call to ogip2spex.</p>
<p>At the end of the program, the spo and res files are saved:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Writing SPO to file: M1.spo
Writing RES to file: M1.res
</pre></div>
</div>
<p>One can overwrite existing files by adding the ‘–overwrite’ option to the ogip2spex call.</p>
<p>This spo file has an ‘Exp_Rate’ column. To generate a spo file without such a column, add ‘–no-exprate’ to the
ogip2spex call.</p>
<p>By default, ogip2spex shows colored output for warnings, errors and OKs. If it is hard for you to see, use the
‘–no-color’ argument to show the output without colors.</p>
</section>
<section id="command-line-arguments">
<span id="ogip2spex-commandline"></span><h2>Command-line arguments<a class="headerlink" href="#command-line-arguments" title="Permalink to this headline">¶</a></h2>
<p><p>See full documentation at: <a class="reference external" href="https://spex-xray.github.io/pyspextools">https://spex-xray.github.io/pyspextools</a></p>
</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">ogip2spex</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">--</span><span class="n">phafile</span> <span class="n">PHAFILE</span> <span class="p">[</span><span class="o">--</span><span class="n">bkgfile</span> <span class="n">BKGFILE</span><span class="p">]</span> <span class="o">--</span><span class="n">rmffile</span> <span class="n">RMFFILE</span> <span class="p">[</span><span class="o">--</span><span class="n">arffile</span> <span class="n">ARFFILE</span><span class="p">]</span> <span class="o">--</span><span class="n">spofile</span> <span class="n">SPOFILE</span> <span class="o">--</span><span class="n">resfile</span> <span class="n">RESFILE</span>
                 <span class="p">[</span><span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="n">badchannels</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="n">grouping</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">overwrite</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">exprate</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">poisson</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">color</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">version</span><span class="p">]</span>
</pre></div>
</div>
<section id="named-arguments">
<h3>Named Arguments<a class="headerlink" href="#named-arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--phafile</kbd></dt>
<dd><p>Input PHA source spectrum (required)</p>
</dd>
<dt><kbd>--bkgfile</kbd></dt>
<dd><p>Input Background spectrum</p>
</dd>
<dt><kbd>--rmffile</kbd></dt>
<dd><p>Input Response matrix (required)</p>
</dd>
<dt><kbd>--arffile</kbd></dt>
<dd><p>Input Effective area file</p>
</dd>
<dt><kbd>--spofile</kbd></dt>
<dd><p>Output SPEX spectrum file (.spo, required)</p>
</dd>
<dt><kbd>--resfile</kbd></dt>
<dd><p>Output SPEX response file (.res, required)</p>
</dd>
<dt><kbd>--keep-badchannels</kbd></dt>
<dd><p>Do not remove bad channels.</p>
<p>Default: True</p>
</dd>
<dt><kbd>--keep-grouping</kbd></dt>
<dd><p>Retain the grouping information from the PHA file.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--overwrite</kbd></dt>
<dd><p>Overwrite existing spo and res files with same name.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--no-exprate</kbd></dt>
<dd><p>Do not write additional Exp_Rate column (SPEX &lt;=3.04.00).</p>
<p>Default: True</p>
</dd>
<dt><kbd>--force-poisson</kbd></dt>
<dd><p>Force the use of Poisson statistics for the input spectra.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--no-color</kbd></dt>
<dd><p>Suppress color output.</p>
<p>Default: True</p>
</dd>
<dt><kbd>--version</kbd></dt>
<dd><p>show program’s version number and exit</p>
</dd>
</dl>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install pyspextools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Pyspextools tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#using-the-pyspextools-scripts">Using the pyspextools scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#using-the-pyspextools-api">Using the pyspextools API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#using-the-spex-user-model">Using the SPEX user model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Module reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../tutorials.html">Pyspextools tutorials</a><ul>
      <li>Previous: <a href="../tutorials.html" title="previous chapter">Pyspextools tutorials</a></li>
      <li>Next: <a href="tg2spex.html" title="next chapter">TG2Spex - Convert Chandra grating data</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018-2024, SRON Netherlands Institute for Space Research.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tutorials/ogip2spex.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>